<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Queries the Human Cell Atlas • cellNexus</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="96x96" href="favicon-96x96.png">
<link rel="icon" type="”image/svg+xml”" href="favicon.svg">
<link rel="apple-touch-icon" sizes="180x180" href="apple-touch-icon.png">
<link rel="icon" sizes="any" href="favicon.ico">
<link rel="manifest" href="site.webmanifest">
<script src="deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="deps/headroom-0.11.0/headroom.min.js"></script><script src="deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="deps/search-1.0.0/fuse.min.js"></script><script src="deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="pkgdown.js"></script><meta property="og:title" content="Queries the Human Cell Atlas">
<meta name="description" content="Provides access to a copy of the Human Cell Atlas, but with harmonised metadata. This allows for uniform querying across numerous datasets within the Atlas using common fields such as cell type, tissue type, and patient ethnicity. Usage involves first querying the metadata table for cells of interest, and then downloading the corresponding cells into one of several supported formats, including SingleCellExperiment, Seurat, or pseudobulk SummarizedExperiment objects. Note: The Human Cell Atlas data accessed through this package is subject to its own licensing terms (typically Creative Commons Attribution or similar open data licenses as specified by the Human Cell Atlas Data Use Agreement), which differ from the package license (GPL-3). See the package documentation for details.">
<meta property="og:description" content="Provides access to a copy of the Human Cell Atlas, but with harmonised metadata. This allows for uniform querying across numerous datasets within the Atlas using common fields such as cell type, tissue type, and patient ethnicity. Usage involves first querying the metadata table for cells of interest, and then downloading the corresponding cells into one of several supported formats, including SingleCellExperiment, Seurat, or pseudobulk SummarizedExperiment objects. Note: The Human Cell Atlas data accessed through this package is subject to its own licensing terms (typically Creative Commons Attribution or similar open data licenses as specified by the Human Cell Atlas Data Use Agreement), which differ from the package license (GPL-3). See the package documentation for details.">
<meta property="og:image" content="https://mangiolalaboratory.github.io/cellNexus/logo.png">
</head>
<body>
<p>









  pkgdown/extra.html

  

  </p>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-primary" data-bs-theme="dark" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="index.html">cellNexus</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.99.4</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="active nav-item"><a class="nav-link" href="index.html">home</a></li>
<li class="nav-item"><a class="external-link nav-link" href="https://j-andrews7-cellnexus.share.connect.posit.cloud/">Query builder</a></li>
<li class="nav-item"><a class="nav-link" href="articles/gene-expression-explore.html">gene expression explore</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/MangiolaLaboratory/cellNexus/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-home">
<div class="row">
  <main id="main" class="col-md-9"><div class="section level1">
<div class="page-header">
<img src="logo.png" class="logo" alt=""><h1 id="cellnexus">cellNexus<a class="anchor" aria-label="anchor" href="#cellnexus"></a>
</h1>
</div>
<p><code>cellNexus</code> is a query interface for programmatic exploration and retrieval of harmonised, curated, and reannotated CELLxGENE human-cell-atlas data.</p>
<p align="center">
<img src="abstract.png" alt="cellNexus abstract overview" style="max-width: 100%; width: 980px; border-radius: 12px; border: 1px solid rgba(159, 122, 234, 0.35);"></p>
<p>This standalone documentation website provides:</p>
<ul>
<li>Detailed data-processing information (quality control, harmonisation, and expression representations).</li>
<li>Complete explanations of metadata columns used in filtering and interpretation.</li>
<li>Guided examples for metadata-first exploration and gene-expression analysis.</li>
</ul>
<div class="section level2">
<h2 id="start-here">Start Here<a class="anchor" aria-label="anchor" href="#start-here"></a>
</h2>
<ul>
<li>
<strong>Home</strong>: package purpose, architecture, and processing pipeline overview.</li>
<li>
<strong>Metadata Explore</strong>: field-by-field metadata dictionary, examples, and filtering strategy.</li>
<li>
<strong>Gene Expression Explore</strong>: practical workflows for querying single-cell, pseudobulk, and metacell expression.</li>
</ul>
</div>
<div class="section level2">
<h2 id="data-processing-overview">Data Processing Overview<a class="anchor" aria-label="anchor" href="#data-processing-overview"></a>
</h2>
<p>The harmonisation pipeline standardises data across datasets so queries are consistent across studies:</p>
<ol style="list-style-type: decimal">
<li>Metadata are retrieved from cloud-hosted harmonised tables.</li>
<li>Standardised quality control removes empty droplets, dead/damaged cells, and likely doublets.</li>
<li>Cell-level data are served through common assay layers (<code>counts</code>, <code>cpm</code>, pseudobulk, metacell).</li>
<li>Outputs are returned in analysis-ready R formats such as <code>SingleCellExperiment</code> and <code>Seurat</code>.</li>
</ol>
<p>For implementation details and code examples, see the vignettes listed in the top navigation.</p>
</div>
<div class="section level2">
<h2 id="client-usage-examples">Client Usage Examples<a class="anchor" aria-label="anchor" href="#client-usage-examples"></a>
</h2>
<div class="section level3">
<h3 id="r-client-cellnexus">R client (<code>cellNexus</code>)<a class="anchor" aria-label="anchor" href="#r-client-cellnexus"></a>
</h3>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/MangiolaLaboratory/cellNexus" class="external-link">cellNexus</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://stringr.tidyverse.org" class="external-link">stringr</a></span><span class="op">)</span></span>
<span></span>
<span><span class="va">metadata</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/get_metadata.html">get_metadata</a></span><span class="op">(</span>cloud_metadata <span class="op">=</span> <span class="va">SAMPLE_DATABASE_URL</span><span class="op">)</span></span>
<span></span>
<span><span class="va">query</span> <span class="op">&lt;-</span> <span class="va">metadata</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span></span>
<span>    <span class="va">empty_droplet</span> <span class="op">==</span> <span class="cn">FALSE</span>,</span>
<span>    <span class="va">alive</span> <span class="op">==</span> <span class="cn">TRUE</span>,</span>
<span>    <span class="va">scDblFinder.class</span> <span class="op">!=</span> <span class="st">"doublet"</span>,</span>
<span>    <span class="va">self_reported_ethnicity</span> <span class="op">==</span> <span class="st">"African"</span>,</span>
<span>    <span class="fu"><a href="https://stringr.tidyverse.org/reference/str_like.html" class="external-link">str_like</a></span><span class="op">(</span><span class="va">assay</span>, <span class="st">"%10x%"</span><span class="op">)</span>,</span>
<span>    <span class="va">tissue</span> <span class="op">==</span> <span class="st">"lung parenchyma"</span>,</span>
<span>    <span class="fu"><a href="https://stringr.tidyverse.org/reference/str_like.html" class="external-link">str_like</a></span><span class="op">(</span><span class="va">cell_type</span>, <span class="st">"%CD4%"</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span></span>
<span><span class="va">sce</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/get_single_cell_experiment.html">get_single_cell_experiment</a></span><span class="op">(</span><span class="va">query</span>, assays <span class="op">=</span> <span class="st">"cpm"</span><span class="op">)</span></span>
<span><span class="va">pb</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/get_pseudobulk.html">get_pseudobulk</a></span><span class="op">(</span><span class="va">query</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="python-client-cellnexuspy">Python client (<code>cellNexusPy</code>)<a class="anchor" aria-label="anchor" href="#python-client-cellnexuspy"></a>
</h3>
<p>Python support is available in the companion repository: <a href="https://github.com/MangiolaLaboratory/cellNexusPy" class="external-link"><code>MangiolaLaboratory/cellNexusPy</code></a>.</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb2-1"><a href="#cb2-1" tabindex="-1"></a><span class="im">from</span> cellnexuspy <span class="im">import</span> get_metadata, get_anndata</span>
<span id="cb2-2"><a href="#cb2-2" tabindex="-1"></a></span>
<span id="cb2-3"><a href="#cb2-3" tabindex="-1"></a>sample_dataset <span class="op">=</span> <span class="st">"https://object-store.rc.nectar.org.au/v1/AUTH_06d6e008e3e642da99d806ba3ea629c5/cellNexus-metadata/sample_metadata.1.3.0.parquet"</span></span>
<span id="cb2-4"><a href="#cb2-4" tabindex="-1"></a>conn, table <span class="op">=</span> get_metadata(parquet_url<span class="op">=</span>sample_dataset)</span>
<span id="cb2-5"><a href="#cb2-5" tabindex="-1"></a></span>
<span id="cb2-6"><a href="#cb2-6" tabindex="-1"></a>table <span class="op">=</span> table.<span class="bu">filter</span>(<span class="st">"""</span></span>
<span id="cb2-7"><a href="#cb2-7" tabindex="-1"></a><span class="st">    empty_droplet = 'false'</span></span>
<span id="cb2-8"><a href="#cb2-8" tabindex="-1"></a><span class="st">    AND alive = 'true'</span></span>
<span id="cb2-9"><a href="#cb2-9" tabindex="-1"></a><span class="st">    AND "scDblFinder.class" != 'doublet'</span></span>
<span id="cb2-10"><a href="#cb2-10" tabindex="-1"></a><span class="st">    AND feature_count &gt;= 5000</span></span>
<span id="cb2-11"><a href="#cb2-11" tabindex="-1"></a><span class="st">"""</span>)</span>
<span id="cb2-12"><a href="#cb2-12" tabindex="-1"></a></span>
<span id="cb2-13"><a href="#cb2-13" tabindex="-1"></a>query <span class="op">=</span> table.<span class="bu">filter</span>(<span class="st">"""</span></span>
<span id="cb2-14"><a href="#cb2-14" tabindex="-1"></a><span class="st">    self_reported_ethnicity = 'African'</span></span>
<span id="cb2-15"><a href="#cb2-15" tabindex="-1"></a><span class="st">    AND assay LIKE '</span><span class="sc">%10%</span><span class="st">'</span></span>
<span id="cb2-16"><a href="#cb2-16" tabindex="-1"></a><span class="st">    AND tissue = 'lung parenchyma'</span></span>
<span id="cb2-17"><a href="#cb2-17" tabindex="-1"></a><span class="st">    AND cell_type LIKE '%CD4%'</span></span>
<span id="cb2-18"><a href="#cb2-18" tabindex="-1"></a><span class="st">"""</span>)</span>
<span id="cb2-19"><a href="#cb2-19" tabindex="-1"></a></span>
<span id="cb2-20"><a href="#cb2-20" tabindex="-1"></a>adata <span class="op">=</span> get_anndata(query, assay<span class="op">=</span><span class="st">"cpm"</span>)</span>
<span id="cb2-21"><a href="#cb2-21" tabindex="-1"></a>pb <span class="op">=</span> get_anndata(query, aggregation<span class="op">=</span><span class="st">"pseudobulk"</span>)</span>
<span id="cb2-22"><a href="#cb2-22" tabindex="-1"></a>conn.close()</span></code></pre></div>
</div>
</div>
</div>
  </main><aside class="col-md-3"><div class="links">
<h2 data-toc-skip>Links</h2>
<ul class="list-unstyled">
<li><a href="https://github.com/MangiolaLaboratory/cellNexus/" class="external-link">Browse source code</a></li>
<li><a href="https://github.com/MangiolaLaboratory/cellNexus/issues" class="external-link">Report a bug</a></li>
</ul>
</div>

<div class="license">
<h2 data-toc-skip>License</h2>
<ul class="list-unstyled">
<li><a href="LICENSE.html">Full license</a></li>
<li><small><a href="https://www.r-project.org/Licenses/GPL-3" class="external-link">GPL-3</a></small></li>
</ul>
</div>


<div class="citation">
<h2 data-toc-skip>Citation</h2>
<ul class="list-unstyled">
<li><a href="authors.html#citation">Citing cellNexus</a></li>
</ul>
</div>

<div class="developers">
<h2 data-toc-skip>Developers</h2>
<ul class="list-unstyled">
<li>Stefano Mangiola <br><small class="roles"> Author, reviewer, contributor </small> <a href="https://orcid.org/0000-0001-7474-836X" target="orcid.widget" aria-label="ORCID" class="external-link"><span class="fab fa-orcid orcid" aria-hidden="true"></span></a>  </li>
<li>Mengyuan Shen <br><small class="roles"> Author, maintainer, reviewer </small> <a href="https://orcid.org/0009-0008-0057-8239" target="orcid.widget" aria-label="ORCID" class="external-link"><span class="fab fa-orcid orcid" aria-hidden="true"></span></a>  </li>
<li>Michael Milton <br><small class="roles"> Author, reviewer, contributor </small> <a href="https://orcid.org/0000-0002-8965-2595" target="orcid.widget" aria-label="ORCID" class="external-link"><span class="fab fa-orcid orcid" aria-hidden="true"></span></a>  </li>
<li>Silicon Valley Foundation CZF2019-002443 <br><small class="roles"> Funder </small>   </li>
<li>NIH NHGRI 5U24HG004059-18 <br><small class="roles"> Funder </small>   </li>
<li>Victoria Cancer Agency ECRF21036 <br><small class="roles"> Funder </small>   </li>
<li>NHMRC 1116955 <br><small class="roles"> Funder </small>   </li>
<li><a href="authors.html">More about authors...</a></li>
</ul>
</div>



  </aside>
</div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Stefano Mangiola, Mengyuan Shen, Michael Milton, Silicon Valley Foundation CZF2019-002443, NIH NHGRI 5U24HG004059-18, Victoria Cancer Agency ECRF21036, NHMRC 1116955.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.2.0.</p>
</div>

    </footer>
</div>





  
</body>
</html>
