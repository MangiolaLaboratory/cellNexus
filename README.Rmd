---
output:
  rmarkdown::github_document
---


Load Metadata

```{r}
library(HCAquery)
library(dplyr)
library(dbplyr)
library(SingleCellExperiment)
library(tidySingleCellExperiment)

hca_metadata = get_metadata()
```



```{r}
hca_metadata |> 
	distinct(.sample)
```

```{r}
hca_metadata |> 
	  distinct(file_id)
```

```{r}
hca_metadata |> 
	  distinct(cell_type)
```
```{r}
hca_metadata |> 
	distinct(tissue, file_id) |> 
	count(tissue) |> 
	arrange(desc(n))
```

Query

```{r}
sce = 
	hca_metadata |> 
	filter(
		ethnicity == "African" & 
		assay %LIKE% "%10x%" & 
		tissue == "lung parenchyma" & 
		cell_type %LIKE% "%CD4%"
	) |> 
	get_SingleCellExperiment()
	
sce
```


